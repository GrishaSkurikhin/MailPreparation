# Mail Preparation
**Mail Preparation** - система автоматизированной обработки электронной почты, разработанная в рамках выпускной квалификационной работы бакалавра. 
## Как запустить проект
1. Установить **python** 3.9 и **postgreSQL** 15.
2. Склонировать репозиторий через **git clone** и в терминале зайти в проект.
3. Запустить команду "python -m pip install -r requirements.txt".
4. Установить [poppler](https://poppler.freedesktop.org/) и [tesseract](https://github.com/tesseract-ocr/tesseract). Убедиться, что они доступны через консоль. Для tesseract установить также русский язык.
5. Выполнить команду "python main.py".
## Описание проекта
Основной задачей системы является извлечение данных электронной почты в удобном для анализа формате и получение количественных характеристик по деятельности сотрудников и клиентов (партнеров) компании.

Электронная почта в программу поступает в виде файлов формата eml.
Затем из этих файлов достаются необходимые метаданные (тема, отправитель, получатели, дата отправки и другое), а также текст письма и его вложения.

В дополнение к этой информации указывается наименование компаний-отправителей и компаний-получателей, которые могут быть как партнерами, так и клиентами. 

Программой обрабатываются вложения следующих форматов: pdf, docx, txt. 

Все полученные сведения сохраняются в базе данных.
Это дает возможность формировать поисковые запросы (в том числе и полнотекстовые по тексту и теме письма).

Когда электронные письма загружены в базу данных и произведен их поиск или фильтрация, письма можно получить в следующих форматах: txt, csv и json. 
txt в этом случае представляет собой только корпус текстов писем, а csv и json хранят всю информацию о письмах.

## Описание архитектуры проекта
Для реализации системы были выбраны технологии **Python** и **PostgreSQL** из-за их гибкости и свободного распространения.

В основе базы данных лежат следующие объекты:
1. **Таблицы**:
    1. **messages** – хранит информацию о сообщениях электронной почты. В таблице созданы индексы для полнотекстового поиска, которые оптимизируют быстродействие системы при выполнении запросов на поиск по текстам сообщений.
    2.	**recievers** – хранит информацию о получателях сообщений.
    3.	**email_adresses** – хранит информацию о всех адресах электронной почты.
    4.	**domains** – хранит информацию о доменах и компаниях, которым принадлежат эти домены.
    5.	**companies** – хранит информацию о партнерах и клиентах.
    6.	**files** – хранит информацию о вложениях писем.
2.	**Представления**:
    1.	**v_mails_info** – обобщенная информация о всех письмах.
    2.	**v_companies_domains** – информация о компаниях и их доменах.

Проект разделен на 2 части: **модель** (model) и **представление** (view). 

**Модель** представляет собой слой, отвечающий за работу с данными. В ней происходит создание, чтение и удаление данных, а также логика их обработки. 

Классы модели: 
1. Email – получение данных о письмах из файлов eml.
2. DataStorage – операции с базой данных: создание, удаление, поиск писем и другой дополнительной информации.
3. FileConverter - получение текста из файлов pdf, docx, txt.
4. Mail - класс данных письма.
5. Config - работа с конфигом.
6. Exceptions - дополнительные исключения, возникающие при работе программы.
7. Model - класс модели, собирающий в себе логику всех остальных классов слоя.

**Представление** является слоем, отвечающим за отображение данных. В представлении происходит создание и обновление графического интерфейса, который позволяет пользователю взаимодействовать с данными. 

Интерфейс написан на фреймворке PyQt5 и включает в себя несколько классов окон.